<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.letu.healthplatform.platformmanage.report.mapper.SampleReportMapper" >
  <resultMap id="BaseResultMap" type="com.letu.healthplatform.platformmanage.report.model.SampleReport" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jan 22 16:48:11 CST 2018.
    -->
    <id column="t_id" property="tId" jdbcType="INTEGER" />
    <result column="t_batch_id" property="tBatchId" jdbcType="INTEGER" />
    <result column="t_batch_type" property="tBatchType" jdbcType="INTEGER" />
    <result column="t_user_id" property="tUserId" jdbcType="INTEGER" />
    <result column="t_sale_id" property="tSaleId" jdbcType="INTEGER" />
    <result column="t_report_status" property="tReportStatus" jdbcType="INTEGER" />
    <result column="t_report_time" property="tReportTime" jdbcType="TIMESTAMP" />
    <result column="t_logistics" property="tLogistics" jdbcType="VARCHAR" />
    <result column="t_logistics_number" property="tLogisticsNumber" jdbcType="VARCHAR" />
    <result column="t_status" property="tStatus" jdbcType="INTEGER" />
    <result column="t_createtime" property="tCreatetime" jdbcType="TIMESTAMP" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jan 22 16:48:11 CST 2018.
    -->
    t_id, t_batch_id, t_batch_type, t_user_id, t_sale_id, t_report_status, t_report_time, 
    t_logistics, t_logistics_number, t_status, t_createtime
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    
    select 
    <include refid="Base_Column_List" />
    from t_sample_report
    where t_id = #{tId,jdbcType=INTEGER}
  </select>
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    delete from t_sample_report
        where t_id = #{tId,jdbcType=INTEGER}
  </delete>
  
    <delete id="deleteByBatchId" parameterType="com.letu.healthplatform.platformmanage.report.model.SampleReport" >
    
    delete from t_sample_report
       where   1=1 
       <if test="tBatchId !=null"  >
         and   t_batch_id = #{tBatchId,jdbcType=INTEGER}
       </if>
       <if test="tUserId!=null">
         and   t_user_id=  #{tUserId,jdbcType=INTEGER}
       </if>
  </delete>
  
  
  <insert id="insert" parameterType="com.letu.healthplatform.platformmanage.report.model.SampleReport" >
   
    insert into t_sample_report (t_id, t_batch_id, t_batch_type, 
      t_user_id, t_sale_id, t_report_status, 
      t_report_time, t_logistics, t_logistics_number, 
      t_status, t_createtime)
    values (#{tId,jdbcType=INTEGER}, #{tBatchId,jdbcType=INTEGER}, #{tBatchType,jdbcType=INTEGER}, 
      #{tUserId,jdbcType=INTEGER}, #{tSaleId,jdbcType=INTEGER}, #{tReportStatus,jdbcType=INTEGER}, 
      #{tReportTime,jdbcType=TIMESTAMP}, #{tLogistics,jdbcType=VARCHAR}, #{tLogisticsNumber,jdbcType=VARCHAR}, 
      #{tStatus,jdbcType=INTEGER}, #{tCreatetime,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.letu.healthplatform.platformmanage.report.model.SampleReport" >
  
    insert into t_sample_report
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="tId != null" >
        t_id,
      </if>
      <if test="tBatchId != null" >
        t_batch_id,
      </if>
      <if test="tBatchType != null" >
        t_batch_type,
      </if>
      <if test="tUserId != null" >
        t_user_id,
      </if>
      <if test="tSaleId != null" >
        t_sale_id,
      </if>
      <if test="tReportStatus != null" >
        t_report_status,
      </if>
      <if test="tReportTime != null" >
        t_report_time,
      </if>
      <if test="tLogistics != null" >
        t_logistics,
      </if>
      <if test="tLogisticsNumber != null" >
        t_logistics_number,
      </if>
      <if test="tStatus != null" >
        t_status,
      </if>
      <if test="tCreatetime != null" >
        t_createtime,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="tId != null" >
        #{tId,jdbcType=INTEGER},
      </if>
      <if test="tBatchId != null" >
        #{tBatchId,jdbcType=INTEGER},
      </if>
      <if test="tBatchType != null" >
        #{tBatchType,jdbcType=INTEGER},
      </if>
      <if test="tUserId != null" >
        #{tUserId,jdbcType=INTEGER},
      </if>
      <if test="tSaleId != null" >
        #{tSaleId,jdbcType=INTEGER},
      </if>
      <if test="tReportStatus != null" >
        #{tReportStatus,jdbcType=INTEGER},
      </if>
      <if test="tReportTime != null" >
        #{tReportTime,jdbcType=TIMESTAMP},
      </if>
      <if test="tLogistics != null" >
        #{tLogistics,jdbcType=VARCHAR},
      </if>
      <if test="tLogisticsNumber != null" >
        #{tLogisticsNumber,jdbcType=VARCHAR},
      </if>
      <if test="tStatus != null" >
        #{tStatus,jdbcType=INTEGER},
      </if>
      <if test="tCreatetime != null" >
        #{tCreatetime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.letu.healthplatform.platformmanage.report.model.SampleReport" >
    
    update t_sample_report
    <set >
      <if test="tBatchId != null" >
        t_batch_id = #{tBatchId,jdbcType=INTEGER},
      </if>
      <if test="tBatchType != null" >
        t_batch_type = #{tBatchType,jdbcType=INTEGER},
      </if>
      <if test="tUserId != null" >
        t_user_id = #{tUserId,jdbcType=INTEGER},
      </if>
      <if test="tSaleId != null" >
        t_sale_id = #{tSaleId,jdbcType=INTEGER},
      </if>
      <if test="tReportStatus != null" >
        t_report_status = #{tReportStatus,jdbcType=INTEGER},
      </if>
      <if test="tReportTime != null" >
        t_report_time = #{tReportTime,jdbcType=TIMESTAMP},
      </if>
      <if test="tLogistics != null" >
        t_logistics = #{tLogistics,jdbcType=VARCHAR},
      </if>
      <if test="tLogisticsNumber != null" >
        t_logistics_number = #{tLogisticsNumber,jdbcType=VARCHAR},
      </if>
      <if test="tStatus != null" >
        t_status = #{tStatus,jdbcType=INTEGER},
      </if>
      <if test="tCreatetime != null" >
        t_createtime = #{tCreatetime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where t_id = #{tId,jdbcType=INTEGER}
  </update>
  
  
  
    <update id="updateBatchById" parameterType="com.letu.healthplatform.platformmanage.report.model.SampleReport" >
    
    update t_sample_report
    <set >
      <if test="tBatchType != null" >
        t_batch_type = #{tBatchType,jdbcType=INTEGER},
      </if>
      <if test="tUserId != null" >
        t_user_id = #{tUserId,jdbcType=INTEGER},
      </if>
      <if test="tSaleId != null" >
        t_sale_id = #{tSaleId,jdbcType=INTEGER},
      </if>
      <if test="tReportStatus != null" >
        t_report_status = #{tReportStatus,jdbcType=INTEGER},
      </if>
      <if test="tReportTime != null" >
        t_report_time = #{tReportTime,jdbcType=TIMESTAMP},
      </if>
      <if test="tLogistics != null" >
        t_logistics = #{tLogistics,jdbcType=VARCHAR},
      </if>
      <if test="tLogisticsNumber != null" >
        t_logistics_number = #{tLogisticsNumber,jdbcType=VARCHAR},
      </if>
      <if test="tStatus != null" >
        t_status = #{tStatus,jdbcType=INTEGER},
      </if>
      <if test="tCreatetime != null" >
        t_createtime = #{tCreatetime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where  t_batch_id = #{tBatchId,jdbcType=INTEGER}
  </update>
  
  
  
  <update id="updateByPrimaryKey" parameterType="com.letu.healthplatform.platformmanage.report.model.SampleReport" >
   
    update t_sample_report
    set t_batch_id = #{tBatchId,jdbcType=INTEGER},
      t_batch_type = #{tBatchType,jdbcType=INTEGER},
      t_user_id = #{tUserId,jdbcType=INTEGER},
      t_sale_id = #{tSaleId,jdbcType=INTEGER},
      t_report_status = #{tReportStatus,jdbcType=INTEGER},
      t_report_time = #{tReportTime,jdbcType=TIMESTAMP},
      t_logistics = #{tLogistics,jdbcType=VARCHAR},
      t_logistics_number = #{tLogisticsNumber,jdbcType=VARCHAR},
      t_status = #{tStatus,jdbcType=INTEGER},
      t_createtime = #{tCreatetime,jdbcType=TIMESTAMP}
    where t_id = #{tId,jdbcType=INTEGER}
  </update>
  
 <select id="selectByParam" resultType="map"  parameterType="com.letu.healthplatform.platformmanage.report.model.SampleReport" >
    
     SELECT  t.t_id as tId,tu.user_id as userId,tu.user_name as userName,
     tu.user_sex as userSex,tu.user_telephone as userTelphone,
     t.t_logistics as tLogistics, t.t_logistics_number as tLogisticsNumber,
     t.t_batch_id as tBatchId,ti.t_si_sample_batch as tSampleBatch,
     t.t_batch_type as tBatchType,
     t.t_status as tStatus,tl.t_id AS saleId,tl.t_email AS saleEmail,tl.t_telephone AS saleTelphone,tl.t_user_name AS saleUserName
     ,ti.t_si_number AS batchNumber ,t.t_report_status as tReportStatus
 FROM t_sample_report t  LEFT JOIN t_user tu ON tu.user_id=t.t_user_id  LEFT JOIN t_m_login tl  ON t.t_sale_id=tl.t_id
  LEFT JOIN t_sample_information ti ON t.t_batch_id=ti.t_si_id  
    where  1=1 
    <if test="tId != null" >
        and  t.t_id = #{tId,jdbcType=INTEGER}
      </if>
    <if test="tBatchId != null" >
        and  t.t_batch_id = #{tBatchId,jdbcType=INTEGER}
      </if>
      <if test="tBatchType != null" >
      and  t.t_batch_type = #{tBatchType,jdbcType=INTEGER}
      </if>
      <if test="tUserId != null" >
       and t.t_user_id = #{tUserId,jdbcType=INTEGER}
      </if>
      <if test="tSaleId != null" >
        and t.t_sale_id = #{tSaleId,jdbcType=INTEGER}
      </if>
      <if test="tReportStatus != null" >
        and t.t_report_status = #{tReportStatus,jdbcType=INTEGER}
      </if>
      <if test="tReportTime != null" >
       and  t.t_report_time = #{tReportTime,jdbcType=TIMESTAMP}
      </if>
      <if test="tLogistics != null" >
        and t.t_logistics = #{tLogistics,jdbcType=VARCHAR}
      </if>
      <if test="tLogisticsNumber != null" >
       and  t.t_logistics_number = #{tLogisticsNumber,jdbcType=VARCHAR}
      </if>
      <if test="tStatus != null" >
       and  t.t_status = #{tStatus,jdbcType=INTEGER}
      </if>
      <if test="tCreatetime != null" >
       and  t.t_createtime = #{tCreatetime,jdbcType=TIMESTAMP}
      </if>
      <if test="tSampleBatch != null " >
       and  ti.t_si_sample_batch   like CONCAT('%', #{tSampleBatch}, '%')
      </if>
      <if test="batchNumber!= null and batchNumber!='' " >
       and  ti.t_si_number   like CONCAT('%', #{batchNumber}, '%')
      </if>
      <if test="userName != null and userName!='' " >
       and tu.user_name  like CONCAT('%', #{userName}, '%')
      </if>
      <if test="saleUserName != null and saleUserName!='' " >
       and  tl.t_user_name  like CONCAT('%', #{saleUserName}, '%')
      </if>
      order by t.t_createtime desc
 </select>
 
 
 <select id="selectReportById" resultType="map" parameterType="com.letu.healthplatform.platformmanage.report.model.SampleReport" >
     SELECT  t.t_id,tu.user_id,tu.user_name,tu.user_sex,tu.user_telephone,t.t_logistics, t.t_logistics_number,t.t_batch_id,ti.t_si_sample_batch,t.t_report_status,
          t.t_batch_type,t.t_status,tl.t_id AS saleId,tl.t_email AS saleEmail,tl.t_telephone AS saleTelphone,tl.t_user_name AS saleUserName
,ti.t_si_number AS batchNumber   
 FROM t_sample_report t   LEFT JOIN t_m_login tl  ON t.t_sale_id=tl.t_id
  LEFT JOIN t_sample_information ti ON t.t_batch_id=ti.t_si_id   LEFT JOIN t_user tu ON tu.user_id=t.t_user_id 
  WHERE 1=1  AND t.t_batch_type=1
    <if test="tId != null" >
        and  t.t_id = #{tId,jdbcType=INTEGER}
    </if>
 </select>
 <select id="selectReportByAllId" resultType="map" parameterType="com.letu.healthplatform.platformmanage.report.model.SampleReport" >
     SELECT  t.t_id,tu.user_id,tu.user_name,tu.user_sex,tu.user_telephone,t.t_logistics, t.t_logistics_number,t.t_batch_id,ti.t_si_sample_batch,t.t_report_status,
          t.t_batch_type,t.t_status,tl.t_id AS saleId,tl.t_email AS saleEmail,tl.t_telephone AS saleTelphone,tl.t_user_name AS saleUserName
,ti.t_si_number AS batchNumber   
 FROM t_sample_report t   LEFT JOIN t_m_login tl  ON t.t_sale_id=tl.t_id
  LEFT JOIN t_sample_information ti ON t.t_batch_id=ti.t_si_id   LEFT JOIN t_user tu ON ti.t_recive_user_id=tu.user_id
  WHERE 1=1  AND t.t_batch_type=2
    <if test="tId != null" >
        and  t.t_id = #{tId,jdbcType=INTEGER}
    </if>
 </select>
  
  
   <!-- 批量写入入库 -->
   <insert id="insertBatch"  parameterType="java.util.List" >
       insert into t_sample_report 
       (
        t_batch_id, t_batch_type, 
        t_user_id, t_sale_id
       ) values 
     <foreach collection ="list" item="report" index= "index" separator =",">
       ( 
    	#{report.tBatchId,jdbcType=INTEGER}, #{report.tBatchType,jdbcType=INTEGER}, 
     	#{report.tUserId,jdbcType=INTEGER}, #{report.tSaleId,jdbcType=INTEGER}) 
     </foreach >
  </insert>
  
  
</mapper>